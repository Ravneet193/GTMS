<!DOCTYPE html>
<html>
<head><title> SEARCH CONTRACTS </title>
	<link rel="stylesheet" href= "{{ url_for('static',filename='css/bootstrap.css') }}">
	<link rel="stylesheet" href="{{ url_for('static',filename='css/w3.css') }}">
	<script src ="{{ url_for('static',filename='js/jquery-3.2.0.min.js') }}"></script>
	<link rel="stylesheet" type="text/css" href="{{ url_for('static',filename='css/search.css') }}">
	<script type="text/JavaScript" src="{{ url_for('static',filename='js/search.js') }}"></script>
	<script src="{{ url_for('static',filename='js/bootstrap.min.js')}}"></script>
	
	<script>
	function search(){
		data1 = $("input[name='optradio']:checked").val()
		data2 = document.getElementById('str').value
		data = {'method':data1, 'text':data2}
		$.ajax({
			url: "/search_by",
			data:  JSON.stringify(data),
			type: "POST",
			contentType: 'application/json;charset=UTF-8',		
			success: update_success,
			error: function(error) {
				console.log(error);
				$("#error").html(error.responseText)
			}
		});
	
	}
	function update_success(text){
		// need to parse this text as json and accordingly update the search results in this function
		console.log(text)
		alert(text)
		data = JSON.parse(text)
		
		res = document.getElementById('result')
		res.style.display = "block"
		d = document.getElementById('tab')
		for(var i=0; i<data.length; ++i){
			tr = document.createElement('tr')
			
			td1 = document.createElement('td')
			td1.appendChild(document.createTextNode(data['title']))
			tr.appendChild(td1)
			td2 = document.createElement('td')
			td2.appendChild(document.createTextNode(data['project_id']))
			tr.appendChild(td2)
			td3 = document.createElement('td')
			td3.appendChild(document.createTextNode(data['state']))
			tr.appendChild(td3)
			td4 = document.createElement('td')
			td4.appendChild(document.createTextNode(data['district']))
			tr.appendChild(td4)
			td5 = document.createElement('td')
			td5.appendChild(document.createTextNode(data['project_category']))
			tr.appendChild(td5)
			td6 = document.createElement('td')
			td6.appendChild(document.createTextNode(data['bid_start_date']))
			tr.appendChild(td6)
			td7 = document.createElement('td')
			td7.appendChild(document.createTextNode(data['bid_end_date']))
			tr.appendChild(td7)
			
			tab.appendChild(tr)
		}
	}
	
	</script>
	
</head>
<body bgcolor="#c7d0d9">

<div id="container">

<div class="nav">
  <ul>
    <li class="active"> <a href="/index">&nbsp&nbsp&nbsp Home &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp|</a> </li>
	<li> <a href="/">   &nbsp&nbsp&nbsp Registration &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp| </a></li>
	<li> <a href="/">&nbsp&nbsp&nbsp Payment Guidelines & Policies &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp|</a> </li>
	<li> <a href="/search" target="_blank">&nbsp&nbsp&nbsp Search &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp|</a> </li>
	<li> <a href="#">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp FAQ's </a> </li>
  </ul>
</div>



<form class="form-horizontal" action="javascript:void(0)">
  <div class="form-group">
    <label class="control-label col-sm-2" >Search By:</label><br>
    <label class="radio-inline"><input type="radio" name="optradio" id="method" value="title" required>Name</label>
	<label class="radio-inline"><input type="radio" name="optradio" id="method" value="project_category">Department</label>
	<label class="radio-inline"><input type="radio" name="optradio" id="method" value="district">District</label>
	<label class="radio-inline"><input type="radio" name="optradio" id="method" value="state">State</label>
  </div>
  <div class="form-group">
    <label class="control-label col-sm-2">TEXT</label>
    <div class="col-sm-10"> 
      <input type="text" class="form-control" id="str" placeholder="Enter TEXT">
    </div>
  </div>
  
  <div class="form-group"> 
    <div class="col-sm-offset-2 col-sm-10">
      <button type="submit" class="btn btn-default" onclick="search()">Submit</button>
    </div>
  </div>
</form>

<br><br><br><br><br><br><br><br>  
<div width="800px" height="800px" id="statehit"></div>
<div class="container" id="result" style="display:none">
    <table class="table table-hover" >
		<thead>
		   <tr>
			  <th>Title</th>
			  <th>Project id</th>
			  <th>State</th>
			  <th>District</th>
			  <th>Category</th>
			  <th>Start date</th>
			  <th>End date</th>
		   </tr>
		</thead>
		<tbody id='tab'>
		   
		</tbody>
	</table>
</div>



<div class="footer" align="margin-bottom">
<ul>
  <li> Copyright. All rights reserved. &nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp</li>
  <li><a href="tandc.html" target="_blank"> Terms & conditions&nbsp&nbsp&nbsp&nbsp&nbsp| </a></li>
  <li><a href="e-disclaimer.html" target="_blank"> &nbsp&nbsp&nbsp&nbspDisclaimer </a></li>
</ul>
</div>


 </div>
</body>

</html>